# å¹³å° API å¼€å‘ä¸é›†æˆ

## Cloudflare

### R2 Object Storage

> å‚è€ƒæ–‡ç« ï¼š[Cloudflare R2 å¯¹è±¡å­˜å‚¨æ­å»ºé«˜é€Ÿå…è´¹å›¾åºŠå®Œå…¨æŒ‡å—](https://www.oneyangcrown.top/posts/cloudflare-r2-free-image-hosting-guide/)

Cloudflare R2 æ˜¯ä¸€ä¸ªå¯¹è±¡å­˜å‚¨æœåŠ¡ï¼Œç±»ä¼¼äº AWS S3ã€‚å®ƒæä¾›äº†ä¸€ä¸ªç®€å•çš„ API æ¥å­˜å‚¨å’Œæ£€ç´¢æ•°æ®ã€‚

- åœ¨è®¾ç½®ä¸­å¯ä»¥è‡ªå®šä¹‰åŸŸåï¼ˆåŸŸåéœ€è¦æ‰˜ç®¡åœ¨ Cloudflare ä¸Šï¼‰ï¼Œå¹¶è®¾ç½® CORS ç­–ç•¥

- å¯ä»¥ä½¿ç”¨ `rclone` å·¥å…·æ¥ç®¡ç† R2 å­˜å‚¨æ¡¶ [--> ç«™å†…ç›¸å…³å†…å®¹é“¾æ¥](/notes/cli_tools.html#rclone)

- R2 çš„ API Tokens å­˜å‚¨æƒé™åˆ† `Admin Read & Write` å’Œ `Object Read & Write`ã€‚

  å¦‚æœæ˜¯åœ¨å­˜å‚¨æ¡¶æ ¹ç›®å½•ä¸‹ä¸Šä¼ æ–°çš„æ–‡ä»¶ï¼Œå¯èƒ½ä¼šé‡åˆ° `Access Denied` é”™è¯¯ï¼ˆæœªæ·±ç©¶å…·ä½“åŸå› ï¼‰ï¼Œè¿™æ—¶éœ€è¦ä½¿ç”¨ `Admin Read & Write` æƒé™çš„ API Tokenã€‚

## äºšé©¬é€Š

### åè¯æ¦‚å¿µ

- **AWS**ï¼šAmazon Web Servicesï¼Œäºšé©¬é€Šäº‘æœåŠ¡å¹³å°

- **IAM**ï¼šIdentity and Access Managementï¼Œèº«ä»½å’Œè®¿é—®ç®¡ç†ï¼Œç”¨äºç®¡ç† AWS èµ„æºçš„è®¿é—®æƒé™

- **S3**ï¼šSimple Storage Serviceï¼Œäºšé©¬é€Šç®€å•å­˜å‚¨æœåŠ¡ï¼Œç”¨äºå­˜å‚¨å’Œæ£€ç´¢ä»»æ„æ•°é‡çš„æ•°æ®

- **EC2**ï¼šElastic Compute Cloudï¼Œäºšé©¬é€Šå¼¹æ€§è®¡ç®—äº‘ï¼Œç”¨äºæä¾›è™šæ‹ŸæœåŠ¡å™¨

- **Route 53**ï¼šAmazon Route 53ï¼Œäºšé©¬é€Šè·¯ç”± 53ï¼Œç”¨äºç®¡ç† DNS è®°å½•

- **CloudFront**ï¼šäºšé©¬é€Šçš„å†…å®¹åˆ†å‘ç½‘ç»œï¼ˆCDNï¼‰ï¼Œç”¨äºåŠ é€Ÿé™æ€å’ŒåŠ¨æ€å†…å®¹çš„åˆ†å‘

- **CloudWatch**ï¼šäºšé©¬é€Šçš„ç›‘æ§æœåŠ¡ï¼Œç”¨äºç›‘æ§ AWS èµ„æºå’Œåº”ç”¨ç¨‹åº

  å¦‚æœè¦æŸ¥çœ‹ CloudWatch çš„æ—¥å¿—ï¼Œéœ€è¦å…ˆåœ¨ IAM ä¸­åˆ›å»ºä¸€ä¸ªå…·æœ‰ `CloudWatchLogsReadOnlyAccess` æƒé™çš„ç”¨æˆ·ï¼Œå¹¶åˆ†é…ç»™ EC2 å®ä¾‹ã€‚

- **EBS**ï¼šElastic Block Storeï¼Œäºšé©¬é€Šå¼¹æ€§å—å­˜å‚¨ï¼Œç”¨äºä¸º EC2 å®ä¾‹æä¾›æŒä¹…åŒ–å­˜å‚¨

- **VPC**ï¼šVirtual Private Cloudï¼Œäºšé©¬é€Šè™šæ‹Ÿç§æœ‰äº‘ï¼Œç”¨äºåˆ›å»ºå’Œç®¡ç†è™šæ‹Ÿç½‘ç»œ

- **AMIs**ï¼šAmazon Machine Imagesï¼Œäºšé©¬é€Šæœºå™¨é•œåƒï¼Œç”¨äºåˆ›å»º EC2 å®ä¾‹çš„æ¨¡æ¿

### EC2

#### è¿ç§»ä¸åŒåŒºåŸŸçš„å®ä¾‹ï¼ˆé•œåƒå®ç°ï¼‰

æœ¬æ–¹æ¡ˆåŸºäº AMI çš„é•œåƒå¤åˆ¶ï¼ˆé€‚åˆå°è§„æ¨¡/å…è®¸åœæœºï¼‰ï¼Œå¦‚æœéœ€è¦è¿ç§»å¤§è§„æ¨¡å®ä¾‹ï¼Œå»ºè®®ä½¿ç”¨ `AWS Application Migration Serviceï¼ˆMGNï¼‰`ã€‚

1. åœ¨ç¾å›½çš„å®ä¾‹ä¸Šï¼Œåˆ›å»ºä¸€ä¸ª **Amazon Machine Image (AMI)**ã€‚

   ç™»å½• **AWS ç®¡ç†æ§åˆ¶å°**ï¼Œè¿›å…¥ **EC2 â†’ å®ä¾‹** é¡µé¢ã€‚

   æ‰¾åˆ°ä½ è¦è¿ç§»çš„ç¾å›½æœåŠ¡å™¨å®ä¾‹ï¼Œ**å³é”® â†’ é•œåƒå’Œæ¨¡æ¿ â†’ åˆ›å»ºæ˜ åƒ (Create Image)**ã€‚

   å¡«å†™æ˜ åƒåç§°å’Œæè¿°ï¼Œç„¶åç‚¹å‡» **åˆ›å»ºæ˜ åƒ**ã€‚

2. åœ¨ AWS æ§åˆ¶å°æˆ– CLI ä¸­ï¼Œå°†è¯¥ AMI **å¤åˆ¶åˆ°ä¸œäº¬åŒºåŸŸ**ã€‚

   ç­‰å¾…å‡ åˆ†é’Ÿåï¼Œä½ ä¼šåœ¨ **AMI é¡µé¢**ï¼ˆå·¦è¾¹å¯¼èˆªæ  â†’ æ˜ åƒ â†’ AMIsï¼‰çœ‹åˆ°åˆšç”Ÿæˆçš„é•œåƒã€‚

   **æ³¨æ„**ï¼šéœ€è¦ç­‰å¾…é•œåƒçŠ¶æ€å˜ä¸º `available` åæ‰èƒ½å¤åˆ¶ï¼Œå¦åˆ™ä¼šæç¤ºæ‰¾ä¸åˆ°è¯¥é•œåƒã€‚å¯ä»¥åœ¨ `å¿«ç…§` ä¸­æŸ¥çœ‹é•œåƒåˆ›å»ºè¿›åº¦ã€‚

   é€‰ä¸­é•œåƒï¼Œç‚¹å‡» **æ“ä½œ â†’ å¤åˆ¶ AMI**ï¼Œé€‰æ‹©ç›®æ ‡åŒºåŸŸï¼ˆæ¯”å¦‚ **Asia Pacific (Tokyo)**ï¼‰ï¼Œè¿™é€šå¸¸ä¹Ÿéœ€è¦å‡ åˆ†é’Ÿæ—¶é—´ã€‚

3. åœ¨ä¸œäº¬åŒºåŸŸç”¨è¿™ä¸ª AMI å¯åŠ¨æ–°çš„ EC2 å®ä¾‹ã€‚

4. å¦‚æœæœ‰ EBS æ•°æ®å·ï¼Œä¹Ÿéœ€è¦åˆ†åˆ«åš **å¿«ç…§** å¹¶å¤åˆ¶åˆ°ä¸œäº¬åŒºåŸŸã€‚

5. è°ƒæ•´å®‰å…¨ç»„ã€å¼¹æ€§ IPã€VPC å­ç½‘ç­‰é…ç½®ã€‚

6. åˆ‡æ¢ DNS æˆ–è€…è´Ÿè½½å‡è¡¡æŒ‡å‘æ–°å®ä¾‹ã€‚

### Route53

Route53 æ˜¯ AWS æä¾›çš„ DNS æœåŠ¡ï¼Œå¯ä»¥ç”¨äºç®¡ç†åŸŸåå’Œ IP åœ°å€çš„æ˜ å°„å…³ç³»ã€‚

#### ä¿®æ”¹åŸŸå Nameserver

> è¿ç§»åŸŸåæ—¶åˆ«é€‰æ‹©ä¿ç•™åŸ DNSï¼Œè€Œæ˜¯é€‰æ‹©ä½¿ç”¨ Route53 æä¾›çš„ DNSï¼Œä¸ç„¶è¿™ä¸€æ­¥å°±ä¸€å®šè¦åšï¼Œä¸ç„¶ä¼šå‡ºé—®é¢˜ã€‚

åœ¨ AWS Route53 ä¸­ï¼Œå¯ä»¥ä¿®æ”¹åŸŸåçš„ Nameserverã€‚

1. æ‰“å¼€ AWS Route 53 æ§åˆ¶å° â†’ Registered Domains
2. æ‰¾åˆ°ä½ çš„åŸŸåï¼Œç‚¹å‡»è¿›å…¥
3. è¿›å…¥ â€œName serversâ€ åŒºå—ï¼Œç‚¹å‡» â€œAdd or Edit name serversâ€
4. æ›¿æ¢ä¸ºæ–°çš„ Nameserverï¼Œç‚¹å‡» â€œSave changesâ€

#### åŸŸåè½¬å…¥æ¨èæµç¨‹

1. æ‰“å¼€ AWS Route 53 æ§åˆ¶å° â†’ æ‰˜ç®¡åŒºåŸŸ â†’ æ·»åŠ æ‰˜ç®¡åŒºåŸŸ â†’ è¾“å…¥è¦è½¬å…¥çš„åŸŸåï¼ˆè·å¾— 4 æ¡ NS è®°å½•ï¼‰
2. åœ¨æ‰˜ç®¡åŒºåŸŸæ·»åŠ åŸåŸŸåçš„è§£æè®°å½•ï¼ˆåŸåŸŸåæ³¨å†Œå•†å¤„è·å–ï¼Œå¯ä»¥é€šè¿‡å¯¼å‡ºå¯¼å…¥çš„æ–¹å¼ï¼‰
3. ç™»å½•åŸåŸŸåæ³¨å†Œå•† â†’ æ‰¾åˆ°åŸŸåç®¡ç† â†’ ä¿®æ”¹ Nameserver ä¸º AWS Route 53 æä¾›çš„ NS è®°å½•ï¼ˆè¿™æ ·å¯ä»¥ä¿è¯åŸŸåè§£ææ€»æ˜¯æ­£å¸¸ï¼‰
4. [å¯é€‰] å¦‚æœä¹‹å‰çš„åŸŸåå­˜åœ¨å¤‡æ¡ˆï¼Œéœ€è¦å…ˆåœ¨åŸåŸŸåæ³¨å†Œå•†å¤„æ“ä½œå¤‡æ¡ˆè½¬ç§»æˆ–è€…æ³¨é”€å¤‡æ¡ˆï¼ˆä¸ç„¶ä¹‹åæ³¨é”€å¤‡æ¡ˆä¼šå¾ˆéº»çƒ¦ï¼‰
5. åœ¨åŸåŸŸåæ³¨å†Œå•†æ“ä½œ**è½¬å‡ºåŸŸå**ï¼Œè·å¾—è½¬ç§»ç ï¼Œå¹¶åœ¨ AWS Route 53 ä¸­è½¬å…¥åŸŸå

_é˜¿é‡Œäº‘å¯ä»¥å¿«é€Ÿè½¬å‡ºåŸŸåï¼Œåœ¨è½¬å‡ºæµç¨‹é¡µé¢æœ‰â€œå¿«é€Ÿè½¬å‡ºâ€æŒ‰é’®ï¼Œè¿™æ ·é€šå¸¸åªéœ€è¦ 30 åˆ†é’Ÿå·¦å³å°±å¯ä»¥å®ŒæˆåŸŸåè½¬å‡ºï¼Œéå¸¸ä¸æ»‘_

### CloudFront

CloudFront æ˜¯ AWS æä¾›çš„å†…å®¹åˆ†å‘ç½‘ç»œï¼ˆCDNï¼‰ï¼Œå¯ä»¥ç”¨äºåŠ é€Ÿé™æ€å’ŒåŠ¨æ€å†…å®¹çš„åˆ†å‘ã€‚

æ¨èé…å¤‡ï¼Œå¦åˆ™æœåŠ¡å™¨çš„æµé‡ä¼šç›´æ¥æ‰“åˆ° EC2 å®ä¾‹ä¸Šï¼Œå¯¼è‡´æµé‡è´¹ç”¨é«˜ä¸”é€Ÿåº¦æ…¢ã€‚

#### åˆ›å»º CloudFront åˆ†é…

**EC2 å®ä¾‹ç»‘å®šåŸŸå**

1. åœ¨ AWS æ§åˆ¶å°æ‰“å¼€ **CloudFront** æœåŠ¡

2. ç‚¹å‡» **åˆ›å»ºåˆ†é…**

3. **Get started** é¡µé¢å¡«å†™è‡ªå®šä¹‰åˆ«å

4. **Specify origin** é¡µé¢ä¸­ï¼Œ**Origin Type** é€‰æ‹© **Other**ï¼Œå¡«å…¥ **EC2 å®ä¾‹çš„å…¬æœ‰ DNS**ï¼ˆä¸æ”¯æŒ IPï¼‰

5. æ³¨æ„**æº**ä¸­åè®®çš„é€‰æ‹©ï¼Œå¦‚æœæºæ˜¯ HTTPSï¼Œè¿™é‡Œä¹Ÿé€‰æ‹© HTTPSï¼Œå¦åˆ™é€‰æ‹© HTTP Onlyï¼Œä¸ç„¶ä¼šå¯¼è‡´ 502 é”™è¯¯

### CloudWatch Agent

#### å®‰è£…

**æ­¥éª¤ä¸€ï¼šåˆ›å»º IAM è§’è‰²ï¼ˆä»…éœ€ä¸€æ¬¡ï¼‰**

å¦‚æœä½ å°šæœªç»™ EC2 å®ä¾‹åˆ†é… IAM è§’è‰²ï¼Œè¯·å…ˆæ‰§è¡Œæ­¤æ­¥éª¤ã€‚

1. åˆ›å»º IAM è§’è‰²å¹¶é™„åŠ æƒé™

- ç™»å½• AWS æ§åˆ¶å°ï¼Œè¿›å…¥ **IAM > è§’è‰²**ã€‚
- åˆ›å»ºè§’è‰²ï¼Œé€‰æ‹© **EC2** ç±»å‹ã€‚
- é™„åŠ ä»¥ä¸‹ç­–ç•¥ï¼š
  - `AmazonSSMManagedInstanceCore`
  - `CloudWatchAgentServerPolicy`

2. å°†è§’è‰²é™„åŠ åˆ°ä½ çš„ EC2 å®ä¾‹

- è¿›å…¥ EC2 æ§åˆ¶å° > å®ä¾‹ > æ“ä½œ > å®‰å…¨ > ä¿®æ”¹ IAM è§’è‰²ã€‚
- å°†åˆšåˆ›å»ºçš„è§’è‰²åˆ†é…ç»™è¯¥å®ä¾‹ã€‚

**æ­¥éª¤äºŒï¼šå®‰è£… CloudWatch Agent**

1. ç™»å½• EC2 å®ä¾‹

```bash
ssh -i your-key.pem ubuntu@your-ec2-public-ip
```

2. ä¸‹è½½å¹¶å®‰è£… CloudWatch Agent

```bash
sudo apt update
sudo apt install -y wget
wget https://s3.amazonaws.com/amazoncloudwatch-agent/ubuntu/amd64/latest/amazon-cloudwatch-agent.deb
sudo dpkg -i amazon-cloudwatch-agent.deb
```

**æ­¥éª¤ä¸‰ï¼šé…ç½® CloudWatch Agent**

1. åˆ›å»ºé…ç½®æ–‡ä»¶

ä½ å¯ä»¥ç”¨ Amazon æä¾›çš„å‘½ä»¤è¡Œå·¥å…·ç”Ÿæˆé…ç½®æ–‡ä»¶ï¼š

```bash
sudo /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-config-wizard
```

æ ¹æ®æç¤ºé€‰æ‹©éœ€è¦æ”¶é›†çš„æ•°æ®ï¼ˆCPUã€å†…å­˜ã€ç£ç›˜ç­‰ï¼‰ï¼Œå®Œæˆåä¼šç”Ÿæˆä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚ `/opt/aws/amazon-cloudwatch-agent/bin/config.json`ã€‚

2. æˆ–è€…ä½¿ç”¨è¿™ä¸ªæœ€å°é…ç½®æ¨¡æ¿ï¼š

åˆ›å»ºæ–‡ä»¶ `/opt/aws/amazon-cloudwatch-agent/bin/config.json`ï¼š

```json
{
  "metrics": {
    "metrics_collected": {
      "mem": {
        "measurement": ["mem_used_percent"],
        "metrics_collection_interval": 60
      },
      "disk": {
        "measurement": ["used_percent"],
        "metrics_collection_interval": 60,
        "resources": ["*"]
      }
    }
  }
}
```

**æ­¥éª¤å››ï¼šå¯åŠ¨ CloudWatch Agent**

```bash
sudo /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-ctl \
  -a fetch-config \
  -m ec2 \
  -c file:/opt/aws/amazon-cloudwatch-agent/bin/config.json \
  -s
```

**æ­¥éª¤äº”ï¼šåœ¨ CloudWatch æ§åˆ¶å°æŸ¥çœ‹**

1. ç™»å½• AWS æ§åˆ¶å°
2. æ‰“å¼€ **CloudWatch > Metrics > CWAgent**
3. é€‰æ‹©ä½ çš„å®ä¾‹ï¼ŒæŸ¥çœ‹ **å†…å­˜ã€ç£ç›˜ä½¿ç”¨ç‡ç­‰æŒ‡æ ‡**

#### å¸¸ç”¨æ“ä½œ

**æŸ¥çœ‹ Agent çŠ¶æ€**

```bash
sudo /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-ctl -m ec2 -a status
```

**é‡å¯ Agent**

```bash
sudo systemctl restart amazon-cloudwatch-agent
```

**æŸ¥çœ‹æ—¥å¿—ï¼ˆUbuntu é€šå¸¸å¦‚ä¸‹ï¼‰**

```bash
sudo tail -n 50 /opt/aws/amazon-cloudwatch-agent/logs/amazon-cloudwatch-agent.log
```

### AWS Certificate Manager (ACM)

ç”³è¯·ä¸å¯å¯¼å‡ºçš„è¯ä¹¦æ˜¯å…è´¹çš„ï¼Œä½†æ˜¯å¦‚æœæ˜¯å¯å¯¼å‡ºçš„è¯ä¹¦ï¼Œéœ€è¦æ”¯ä»˜ä¸€å®šè´¹ç”¨ã€‚

å¯å¯¼å‡ºå®Œå…¨é™å®šåŸŸåçš„ SSL è¯ä¹¦ 15 ç¾å…ƒ/ä¸ªï¼Œé€šé…ç¬¦è¯ä¹¦ 149 ç¾å…ƒ/ä¸ªã€‚

#### ç”³è¯·å¯ä»¥å¯¼å‡ºçš„è¯ä¹¦

1. ç™»å½• AWS æ§åˆ¶å°ï¼Œè¿›å…¥ **Certificate Manager**ã€‚

2. ç‚¹å‡» **è¯·æ±‚è¯ä¹¦**ã€‚

3. é€‰æ‹© **å…¬æœ‰è¯ä¹¦**ï¼Œç‚¹å‡» **ä¸‹ä¸€æ­¥**ã€‚

4. è¾“å…¥è¦ç”³è¯·çš„åŸŸåï¼Œç‚¹å‡» **ä¸‹ä¸€æ­¥**ã€‚
   å¦‚æœæ˜¯é€šé…ç¬¦çš„è¯ä¹¦ï¼ŒåŸŸåå‰åŠ  `*.`ï¼Œä¾‹å¦‚ `*.example.com`ã€‚

5. é€‰æ‹© **DNS éªŒè¯**ï¼Œç‚¹å‡» **ä¸‹ä¸€æ­¥**ã€‚

6. ç‚¹å‡» **åˆ›å»ºè®°å½•**ï¼Œæ ¹æ®æç¤ºåœ¨ DNS æœåŠ¡å•†å¤„æ·»åŠ  CNAME è®°å½•ã€‚

7. ç­‰å¾…éªŒè¯é€šè¿‡ï¼Œè¯ä¹¦çŠ¶æ€å˜ä¸º **å·²é¢å‘**ã€‚

#### å¯¼å‡ºå¹¶ä½¿ç”¨è¯ä¹¦æ–‡ä»¶

åœ¨é¢å‘åï¼Œå¯ä»¥å¯¼å‡ºè¯ä¹¦æ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦è¾“å…¥ä¸€ä¸ªå¯†ç ï¼Œç”¨äºä¿æŠ¤ç§é’¥ã€‚

ä¸‹è½½åä¼šå¾—åˆ°ä¸‰ä¸ªæ–‡ä»¶ï¼š

```bash
certificate.txt
certificate_chain.txt
private_key.txt
```

å¦‚æœæ˜¯nginxæœåŠ¡å™¨ï¼Œå¯ä»¥ç”¨å‘½ä»¤å°†å®ƒä»¬ä¿®æ”¹ä¸ºéœ€è¦çš„æ–‡ä»¶ï¼š

```bash
cat certificate.txt certificate_chain.txt > fullchain.pem
cp private_key.txt privkey.pem
```

é€šå¸¸äºšé©¬é€Šä¸‹è½½çš„å¯†é’¥æ–‡ä»¶å¼€å¤´ä¸º `-----BEGIN ENCRYPTED PRIVATE KEY-----`ï¼Œ

ç›´æ¥ä½¿ç”¨ä¼šåœ¨æ¯æ¬¡è¯»å–æ—¶ï¼Œè¦æ±‚è¾“å…¥å¯†ç ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æå‰ç§»é™¤å¯†ç ä¿æŠ¤ï¼Œç”Ÿæˆä¸å¸¦å¯†ç çš„ç§é’¥æ–‡ä»¶ï¼š

```bash
openssl rsa -in private_key.txt -out privkey.pem
```

## Vultr

### Cloud Storage

#### äº§å“ç±»å‹

å…±å››ç§å­˜å‚¨ç±»å‹ï¼šBlock Storageã€Object Storageã€File Systemã€Storage Gatewaysï¼Œ

ä¸‹é¢æ˜¯å®ƒä»¬å„è‡ªçš„ç‰¹ç‚¹å’Œåº”ç”¨åœºæ™¯ï¼š

**1. Block Storage ï¼ˆå—å­˜å‚¨ï¼‰**

æŠŠå­˜å‚¨å·åˆ’åˆ†æˆå›ºå®šå¤§å°çš„æ•°æ®å—ï¼Œæ¯ä¸ªå—éƒ½æœ‰å”¯ä¸€æ ‡è¯†ã€‚å¯¹æ“ä½œç³»ç»Ÿæ¥è¯´ï¼Œè¡¨ç°å¾—åƒä¸€å—ç¡¬ç›˜ï¼Œå¯ä»¥æŒ‚è½½åˆ°äº‘ä¸»æœºä¸Šå½“æœ¬åœ°ç›˜ä½¿ç”¨ã€‚

**åº”ç”¨åœºæ™¯åŒ…æ‹¬**ï¼šéœ€è¦é«˜æ€§èƒ½ã€ä½å»¶è¿Ÿçš„è¯»å†™æ“ä½œã€‚æ•°æ®åº“å­˜å‚¨ï¼ˆMySQLã€PostgreSQLã€MongoDB ç­‰ï¼‰ã€‚éœ€è¦æ–‡ä»¶ç³»ç»Ÿçš„åº”ç”¨ï¼ˆä¾‹å¦‚ Web æœåŠ¡çš„æŒä¹…åŒ–å­˜å‚¨ï¼‰ã€‚æ‰©å®¹æœ¬åœ°ç£ç›˜ç©ºé—´ï¼ˆæŒ‚è½½å¤šå—å·ï¼ŒæŒ‰éœ€æ‰©å±•ï¼‰ã€‚

**2. Object Storage ï¼ˆå¯¹è±¡å­˜å‚¨ï¼‰**

> åŒ…å« 1000GB å­˜å‚¨ç©ºé—´ï¼Œæ¯æœˆå›ºå®šæ”¶è´¹ã€‚è¶…è¿‡å¥—é¤çš„éƒ¨åˆ†é¢å¤–æ”¶è´¹ã€‚

ä»¥â€œå¯¹è±¡â€çš„å½¢å¼å­˜å‚¨æ•°æ®ï¼Œæ¯ä¸ªå¯¹è±¡ç”±æ–‡ä»¶æ•°æ® + å…ƒæ•°æ® + å”¯ä¸€ ID ç»„æˆã€‚é€šè¿‡ HTTP(S) API è®¿é—®ï¼ˆS3 å…¼å®¹ï¼‰ã€‚æ²¡æœ‰å±‚çº§ç›®å½•ç»“æ„ï¼ˆæ–‡ä»¶å¤¹åªæ˜¯é€»è¾‘ä¸Šçš„ key å‰ç¼€ï¼‰ã€‚

**åº”ç”¨åœºæ™¯åŒ…æ‹¬**ï¼šé™æ€æ–‡ä»¶æ‰˜ç®¡ï¼ˆå›¾ç‰‡ã€è§†é¢‘ã€éŸ³é¢‘ã€æ–‡æ¡£ï¼‰ã€‚å¤‡ä»½ä¸å½’æ¡£ï¼ˆæ•°æ®åº“å¤‡ä»½ã€æ—¥å¿—å½’æ¡£ï¼‰ã€‚å†…å®¹åˆ†å‘ï¼ˆé…åˆ CDN æä¾›å¤§è§„æ¨¡åˆ†å‘ï¼‰ã€‚å­˜å‚¨æµ·é‡éç»“æ„åŒ–æ•°æ®ï¼ˆå¤§æ–‡ä»¶å­˜å‚¨ã€æ•°æ®æ¹–ï¼‰ã€‚

å¯¹è±¡å­˜å‚¨ä¸‹é¢æœ‰å¤šä¸ªäº§å“å¯ä»¥é€‰æ‹©ï¼Œä¸»è¦åŒºåˆ«åœ¨äºå­˜å‚¨çš„ä»·æ ¼ï¼Œå¦‚æœå¯¹è¯»å–è¦æ±‚ä¸é«˜ï¼Œå¾ˆå°‘è®¿é—®çš„å¤§æ–‡ä»¶ï¼Œå¯ä»¥é€‰æ‹©æœ€ä¾¿å®œçš„ã€‚

**3. File System ï¼ˆæ–‡ä»¶å­˜å‚¨ï¼‰**

æä¾›ä¸€ä¸ªå…±äº«çš„ç½‘ç»œæ–‡ä»¶ç³»ç»Ÿï¼ˆNAS ç±»ä¼¼ NFSï¼‰ã€‚å¯ä»¥è¢«å¤šä¸ªè®¡ç®—å®ä¾‹åŒæ—¶æŒ‚è½½è®¿é—®ã€‚é€‚åˆéœ€è¦æ–‡ä»¶çº§åˆ«å…±äº«çš„åº”ç”¨ã€‚

**åº”ç”¨åœºæ™¯åŒ…æ‹¬**ï¼šå¤šå°åº”ç”¨æœåŠ¡å™¨å…±äº«æ–‡ä»¶ï¼ˆä¾‹å¦‚ WordPress å¤šèŠ‚ç‚¹å…±äº« `wp-content/uploads`ï¼‰ã€‚éœ€è¦æ–‡ä»¶é”ã€ç›®å½•ç»“æ„çš„åº”ç”¨ã€‚ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶å­˜å‚¨ï¼ˆSaaS ç³»ç»Ÿã€å…¬æœ‰äº‘ç›˜ï¼‰ã€‚

**4. Storage Gateways ï¼ˆå­˜å‚¨ç½‘å…³ï¼‰**

ä¸»è¦é’ˆå¯¹ **è£¸é‡‘å±æœåŠ¡å™¨ï¼ˆBare Metalï¼‰**ï¼Œå› ä¸ºè£¸é‡‘å±æ²¡æœ‰äº‘ç£ç›˜æŒ‚è½½çš„ä¾¿åˆ©æ€§ã€‚Storage Gateway å°±æ˜¯ä¸€ä¸ªä¸­é—´å±‚ï¼ŒæŠŠè£¸é‡‘å±æœåŠ¡å™¨ä¸ Vultr File System å¯¹æ¥èµ·æ¥ã€‚è®©å¤šå° Bare Metal å¯ä»¥åŒæ—¶è®¿é—®åŒä¸€ä¸ªå…±äº«å­˜å‚¨ã€‚

**åº”ç”¨åœºæ™¯åŒ…æ‹¬**ï¼šåœ¨è£¸é‡‘å±æœåŠ¡å™¨ä¸Šéœ€è¦å…±äº«å­˜å‚¨èµ„æºã€‚æ„å»ºé«˜å¯ç”¨é›†ç¾¤ï¼ˆå¤šå° Bare Metal è®¿é—®åŒä¸€ä»½æ•°æ®ï¼‰ã€‚æ‰©å±•è£¸é‡‘å±æœ¬åœ°ç¡¬ç›˜å®¹é‡ï¼Œç”¨ç½‘å…³æŒ‚æ¥äº‘å­˜å‚¨ã€‚æ··åˆåœºæ™¯ï¼šè£¸é‡‘å±æä¾›è®¡ç®—æ€§èƒ½ï¼Œæ–‡ä»¶ç³»ç»Ÿ/å¯¹è±¡å­˜å‚¨æä¾›æ•°æ®æŒä¹…åŒ–ã€‚

ğŸ‘‰ ç®€å•è®°å¿†ï¼š

- **Block** = åƒç¡¬ç›˜ â†’ ç»™å•å°ä¸»æœºç”¨ã€‚

- **Object** = åƒç½‘ç›˜ â†’ ç»™åº”ç”¨/ç”¨æˆ·/æµ·é‡æ•°æ®ç”¨ã€‚

- **File** = åƒå…±äº«æ–‡ä»¶å¤¹ â†’ å¤šå°æœºå™¨ä¸€èµ·ç”¨ã€‚

- **Gateway** = æ¡¥æ¢ â†’ è®©è£¸é‡‘å±ä¹Ÿèƒ½ç”¨äº‘æ–‡ä»¶ç³»ç»Ÿã€‚

## é˜¿é‡Œäº‘

### CDN æœåŠ¡

#### å¼€å¯è·¨åŸŸèµ„æºå…±äº«

åœ¨ CDN æ§åˆ¶å° --> åŸŸåç®¡ç† --> é€‰æ‹©åŸŸå --> ç¼“å­˜é…ç½® --> ä¿®æ”¹å‡ºç«™å“åº”å¤´ --> æ·»åŠ :

- `Access-Control-Allow-Origin`: \* (æˆ–è€…æŒ‡å®šåŸŸå)

- `Access-Control-Allow-Methods`: GET, POST, PUT, DELETE, OPTIONS

å³å¯å…è®¸è·¨åŸŸè¯·æ±‚ã€‚

### çŸ­ä¿¡æœåŠ¡

#### é€šè¿‡ API å‘é€çŸ­ä¿¡

è¿™é‡Œä»¥ PHP ä¸ºä¾‹ï¼Œä½¿ç”¨é˜¿é‡Œäº‘çš„çŸ­ä¿¡æœåŠ¡å‘é€çŸ­ä¿¡ã€‚

éœ€è¦ä½¿ç”¨å…¨å±€ Composer å®‰è£…ä¸¤ä¸ªåŒ…ï¼š

```bash
composer require alibabacloud/dysmsapi-20170525 4.1.2
composer require alibabacloud/darabonba-openapi
```

## å¾®ä¿¡å…¬ä¼—å·å¼€å‘

**ç›¸å…³èµ„æº**

- å¼€å‘è€…æ–‡æ¡£ï¼š[å¾®ä¿¡å…¬ä¼—å¹³å°å¼€å‘è€…æ–‡æ¡£](https://developers.weixin.qq.com/doc/offiaccount/Getting_Started/Overview.html)

- æµ‹è¯•å·å¹³å°ï¼š[å…¬ä¼—å¹³å°æµ‹è¯•è´¦å·](https://mp.weixin.qq.com/debug/cgi-bin/sandbox?t=sandbox/login)

- æ¥å£è°ƒè¯•å·¥å…·ï¼š[åœ¨çº¿æ¥å£è°ƒè¯•å·¥å…·](https://mp.weixin.qq.com/debug)

- å¼€å‘è€…å·¥å…·ï¼š[web å¼€å‘è€…å·¥å…·](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)

è¿™äº›èµ„æºéƒ½å¯ä»¥åœ¨ **å¼€å‘æ¥å£ç®¡ç†** --> **å¼€å‘è€…å·¥å…·** æ‰¾åˆ°

### ç¾¤å‘æ¶ˆæ¯

ç¾¤å‘æ¶ˆæ¯çš„æ¥å£ä¸º `https://api.weixin.qq.com/cgi-bin/message/mass/sendall?access_token=ACCESS_TOKEN`

å‘å¸ƒæ¥å£ä¸º `https://api.weixin.qq.com/cgi-bin/freepublish/submit?access_token=ACCESS_TOKEN`

è¦æ³¨æ„å®ƒä»¬çš„åŒºåˆ«ï¼š

- **å‘å¸ƒå›¾æ–‡**åï¼Œå·²å‘å¸ƒçš„å†…å®¹å¯è¢«è‡ªå®šä¹‰èœå•ã€è‡ªåŠ¨å›å¤ã€åˆé›†å¼•ç”¨ç­‰ä½¿ç”¨ã€‚

- **ç¾¤å‘æ¶ˆæ¯**æ˜¯ç›´æ¥å‘é€ç»™ç”¨æˆ·ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¸¸ç†è§£çš„æ¨é€å›¾æ–‡æ¶ˆæ¯ç»™ç”¨æˆ·ã€‚

## ChatGPT/Chatbox ç±» API

### æ¨¡å‹çš„é€‰æ‹©

åœ¨é€‰æ‹©æ¨¡å‹æ—¶ï¼Œé€šå¸¸ä¼šæœ‰ä¸€ä¸ªæ¨¡å‹åˆ—è¡¨ï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©ä¸åŒçš„æ¨¡å‹æ¥è¿›è¡Œå¯¹è¯æˆ–ç”Ÿæˆå›¾ç‰‡ã€‚

æ¨¡å‹çš„åç§°é€šå¸¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚ `deepseek-r1-distill-llama-8b`ã€`dall-e-3` ç­‰ã€‚

å®ƒä»¬è¡¨ç¤ºï¼š

- `deepseek`ï¼šæ¨¡å‹ç±»å‹ï¼Œå¯¹è¯æ¨¡å‹

- `r1`ï¼šæ¨¡å‹ç‰ˆæœ¬ï¼Œé€šå¸¸æ˜¯æ•°å­—

- `distill-llama-8b`ï¼šæ¨¡å‹çš„é…ç½®

  -`distill`ï¼šæ¨¡å‹çš„è®­ç»ƒæ–¹å¼ï¼Œé€šå¸¸æ˜¯ `distill` æˆ– `ft`ï¼ˆfine-tuningï¼‰

  -`llama`ï¼šæ¨¡å‹çš„ç±»å‹ï¼Œå¦‚ `llama`ã€`gpt` ç­‰

  -`8b`ï¼šæ¨¡å‹çš„å¤§å°ï¼Œé€šå¸¸æ˜¯ `8b`ã€`16b` ç­‰ï¼Œè¡¨ç¤ºæ¨¡å‹çš„å‚æ•°é‡ï¼Œ`b` ä»£è¡¨ `billion`ï¼Œå³ 10 äº¿ï¼Œ`8b` è¡¨ç¤º 80 äº¿å‚æ•°

### æ–‡å­—å¯¹è¯

æ–‡å­—å¯¹è¯éƒ½æ˜¯é€šè¿‡ SSE æµçš„æ–¹å¼è¿›è¡Œå›å¤çš„ï¼Œè¿™æ ·æ‰å¯ä»¥å®ç°å®æ—¶å¯¹è¯çš„æ•ˆæœã€‚

å¦‚æœæ˜¯æ–‡ä»¶ï¼Œé€šå¸¸å®¢æˆ·ç«¯ä¼šè§£ææ–‡ä»¶ï¼Œç„¶åå°†æ–‡ä»¶å†…å®¹å‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›å¯¹åº”çš„å›å¤ã€‚

#### åŸºç¡€æ¡ˆä¾‹

**è¯·æ±‚æ•°æ®**

```python
url = "https://api.example.com/chat/completions"
headers = {
  host: 'localhost:3000',
  connection: 'keep-alive',
  'content-length': '1044',
  'sec-ch-ua': '"Not?A_Brand";v="8", "Chromium";v="108"',
  'sec-ch-ua-mobile': '?0',
  'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) xyz.chatboxapp.app/1.10.5 Chrome/108.0.5359.215 Electron/22.3.27 Safari/537.36',
  authorization: 'Bearer 449175e4c05f92119361dfa24887ec3709311ef',
  'content-type': 'application/json',
  baggage: 'sentry-environment=production,sentry-release=1.10.5,sentry-public_key=3cf8d15960fc432cb886d6f62e3716dc,sentry-trace_id=57d8ffae51e3445fa53f0328bdd3536a',
  'sentry-trace': '57d8ffae51e3445fa53f0328bdd3536a-825f60796cb21e4b',
  'sec-ch-ua-platform': '"macOS"',
  accept: '*/*',
  'sec-fetch-site': 'cross-site',
  'sec-fetch-mode': 'cors',
  'sec-fetch-dest': 'empty',
  'accept-encoding': 'gzip, deflate, br',
  'accept-language': 'en-US'
}
data = {
  messages: [
    {
      role: 'system',
      content: '\n' +
        'Current model: deepseek-r1\n' +
        'Current date: 2025-03-11T07:18:15.877Z\n' +
        '\n' +
        'You are a helpful assistant.'
    },
    { role: 'user', content: 'æ‚¨å¥½' },
    {
      role: 'assistant',
      content: 'æ¬¢è¿æ‚¨æ¥åˆ°æ·±åº¦æ±‚ç´¢ï¼æˆ‘æ˜¯æ·±åº¦æ±‚ç´¢çš„ä¸€æ¬¾æ™ºèƒ½åŠ©æ‰‹ï¼Œéšæ—¶å‡†å¤‡å¸®åŠ©æ‚¨è§£ç­”é—®é¢˜ã€æä¾›ä¿¡æ¯æˆ–è€…è¿›è¡Œæ„‰å¿«çš„å¯¹è¯ã€‚è¯·éšæ—¶å‘Šè¯‰æˆ‘æ‚¨éœ€è¦ä»€ä¹ˆå¸®åŠ©ï¼Œæˆ‘ä¼šå°½åŠ›æä¾›ï¼'
    },
  ],
  model: 'deepseek-r1',
  temperature: 0.7,
  top_p: 0.9,
  stream: true
}
```

å¦‚æœæ˜¯**æ–‡ä»¶**ï¼Œè¿˜éœ€è¦å…ˆè¯»å–æ–‡ä»¶å†…å®¹ï¼Œå¹¶ä»¥è¿™æ ·çš„æ ¼å¼è¿›è¡Œå‘é€ï¼š

```json
messages: [
  {
      "role": "user",
      "content": "è¾“å…¥çš„æ–‡å­—å†…å®¹\n\n\n<ATTACHMENT_FILE>\n<FILE_INDEX>File 1</FILE_INDEX>\n<FILE_NAME>æ–‡ä»¶åç§°.md</FILE_NAME>\n<FILE_CONTENT>\n# å†…å®¹æ ‡é¢˜...\n</FILE_CONTENT>\n</ATTACHMENT_FILE>\n"
    }
]
```

å¦‚æœæ˜¯**å›¾ç‰‡**ï¼Œéœ€è¦è½¬æˆ url æˆ–è€… base64 æ ¼å¼è¿›è¡Œå‘é€ï¼š

```json
messages: [
  {
      "role": "user",
      "content": [
        {
          "type": "text",
          "text": "è¾“å…¥çš„å†…å®¹\n[image]"
        },
        {
          "type": "image_url",
          "image_url": {
            "url": "data:image/png;base64,iV...="
          }
        }
      ]
    }
]
```

**è¿”å›æ•°æ®**

è¿”å›çš„æ•°æ®ç±»ä¼¼ä¸‹é¢è¿™æ ·ï¼Œä¸æ–­åœ°å‘é€ç»™å®¢æˆ·ç«¯ï¼Œç›´åˆ°æœ€åä¼šå‘é€ä¸€æ¡ `end` äº‹ä»¶ï¼Œè¡¨ç¤ºå¯¹è¯ç»“æŸã€‚

```json
data: {"choices":[{"delta":{"content":null,"reasoning_content":"â€œ"},"finish_reason":null,"index":0,"logprobs":null}],"object":"chat.completion.chunk","usage":null,"created":1741676945,"system_fingerprint":null,"model":"deepseek-r1","id":"chatcmpl-fbc7c94f-05e2-98d6-840a-897837dac57d"}
```

å¦‚æœæœ‰**é”™è¯¯**æ—¶ä¼šè¿”å›ï¼š

```json
{
  "error": {
    "code": "invalid_type",
    "param": "'messages.[0].content'",
    "message": "Invalid type for 'messages.[0].content': expected one of a string or array of objects, but got an object instead.",
    "type": "invalid_request_error"
  },
  "request_id": "chatcmpl-29eac547-a262-9c24-9690-e4c3a31ad122"
}
```

#### åˆå§‹åŒ–å¯¹è¯åç§°

é€šå¸¸éœ€è¦ç»™å½“å‰å¯¹è¯ä¸€ä¸ªåç§°ï¼Œå¯ä»¥åœ¨æ–°å»ºçš„å¯¹è¯åï¼Œå‘é€ç¬¬ä¸€æ¬¡å¯¹è¯å†…å®¹æ—¶è®© AI å…ˆå¸®å¿™èµ·ä¸€ä¸ªåå­—ï¼Œæ¶ˆæ¯å¯ä»¥ç±»ä¼¼ä¸‹é¢è¿™ç§ï¼š

````json
{
  "messages": [
    {
      "role": "user",
      "content": "Based on the chat history, give this conversation a name.\nKeep it short - 10 characters max, no quotes.\nUse ç®€ä½“ä¸­æ–‡.\nJust provide the name, nothing else.\n\nHere's the conversation:\n\n```\n<ç”¨æˆ·ç¬¬ä¸€æ¬¡å‘é€çš„æ¶ˆæ¯ï¼Œæ›¿æ¢è¿™é‡Œï¼Œä¸åŒ…æ‹¬ç¬¦å·>\n\n---------\n\n\n```\n\nName this conversation in 10 characters or less.\nUse ç®€ä½“ä¸­æ–‡.\nOnly give the name, nothing else.\n\nThe name is:"
    }
  ]
}
````

#### ç›¸å…³çŸ¥è¯†

- **role è§’è‰²**ï¼Œé€šå¸¸æœ‰ `user`ã€`assistant`ã€`system` ä¸‰ç§è§’è‰²

### å›¾ç‰‡ç”Ÿæˆ

**è¯·æ±‚æ•°æ®**

```python
url = "https://api.example.com/images/generations"
headers = {
    "Authorization": "Bearer YOUR_API_KEY",
    "Content-Type": "application/json"
}
data = {
  "prompt": "laiba",
  "response_format": "b64_json",
  "model": "dall-e-3",
  "style": "vivid"
}
```

**è¿”å›æ•°æ®**

```json
{
  "created": 1631234567, // æ—¶é—´æˆ³
  "data": [
    {
      "b64_json": "base64-encoded-image-data" // Base64 ç¼–ç çš„å›¾ç‰‡æ•°æ®
    }
  ]
}
```
